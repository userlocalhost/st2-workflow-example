---
default: create-vm
chain:
    - name: create-vm
      ref: core.local
      parameters:
          cmd: "echo '[create-vm] {{name}}'"
      on-success: provision-vm

    - name: provision-vm
      ref: core.local
      parameters:
          cmd: "echo '[provision-vm] {{action_context}}'"
      on-success: register-dns
      on-failure: unregister-dns

    - name: register-dns
      ref: core.local
      parameters:
          cmd: "echo '[register-dns] {{name}}'"
      on-success: register-lb
      on-failure: unregister-dns

    - name: register-lb
      ref: core.local
      parameters:
          cmd: "echo '[register-lb] {{name}}'"
      on-failure: unregister-dns

    - name: unregister-dns
      ref: core.local
      parameters:
          cmd: "echo '[unregister-dns] {{name}}'"
      on-success: clear-vm

    - name: clear-vm
      ref: core.local
      parameters:
          cmd: "echo '[clear-vm] {{name}}'"
